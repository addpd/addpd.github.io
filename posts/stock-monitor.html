<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png"><link rel="icon" href="/img/avatar.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="蓬三水"><meta name="keywords" content=""><meta name="description" content="如何构建股票监听系统在当今信息爆炸的时代，投资者需要及时获取股票市场的动态信息，以便做出明智的投资决策。本文将详细介绍如何构建一个高效的股票监听系统，帮助您实时监控股票价格、设置预警条件，并进行基本的数据分析。 系统需求分析一个完善的股票监听系统应具备以下功能：  实时数据获取：能够从可靠的数据源获取股票的实时价格、成交量等信息 历史数据分析：支持获取并分析历史交易数据，计算技术指标 预警机制：当"><meta property="og:type" content="article"><meta property="og:title" content="如何构建股票监听系统"><meta property="og:url" content="https://weihao.life/posts/stock-monitor.html"><meta property="og:site_name" content="蓬三水"><meta property="og:description" content="如何构建股票监听系统在当今信息爆炸的时代，投资者需要及时获取股票市场的动态信息，以便做出明智的投资决策。本文将详细介绍如何构建一个高效的股票监听系统，帮助您实时监控股票价格、设置预警条件，并进行基本的数据分析。 系统需求分析一个完善的股票监听系统应具备以下功能：  实时数据获取：能够从可靠的数据源获取股票的实时价格、成交量等信息 历史数据分析：支持获取并分析历史交易数据，计算技术指标 预警机制：当"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-11-15T06:30:00.000Z"><meta property="article:modified_time" content="2025-03-03T13:41:03.281Z"><meta property="article:author" content="蓬三水"><meta property="article:tag" content="股票"><meta property="article:tag" content="监控系统"><meta property="article:tag" content="Python"><meta property="article:tag" content="数据分析"><meta name="twitter:card" content="summary_large_image"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="preload" href="/fonts/LXGWWenKaiGBScreen.woff2" as="font" type="font/woff2" crossorigin="anonymous"><title>如何构建股票监听系统 - 蓬三水</title><link rel="stylesheet" href="/baomitu/twitter-bootstrap@4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"weihao.life",root:"/",version:"1.9.8",typing:{enable:!1,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"always",icon:"❡"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"left",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:9},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:{measurement_id:"G-GEFHFY35Z0"},tencent:{sid:null,cid:null},leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},umami:{src:"https://cloud.umami.is/script.js",website_id:"a1f37736-64bf-45a4-b709-429c35295a51",domains:"weihao.life",start_time:"2024-10-23T00:00:00.000Z",token:"FQS4LpTHiPQvcxmcFfwbUy7zdYRyCYqq",api_server:"https://cloud.umami.is"}},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-GEFHFY35Z0",function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","G-GEFHFY35Z0")})</script><script async>if(!Fluid.ctx.dnt){let t=document.createElement("script");t.defer=!0,t.src="https://cloud.umami.is/script.js",t.setAttribute("data-website-id","a1f37736-64bf-45a4-b709-429c35295a51"),t.setAttribute("data-domains","weihao.life"),document.head.appendChild(t)}</script><meta name="google-site-verification" content="MJrkIoyufUaymuGF4ykicmly4MoZagsRYfaf63fVVlI"><meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>蓬三水的网络日志</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-globe"></i> <span>站点</span></a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="https://eu.umami.is/websites/a1f37736-64bf-45a4-b709-429c35295a51" target="_blank"><span>Umami</span> </a><a class="dropdown-item" href="https://analytics.google.com/analytics/web/?hl=zh-cn#/a266525416p438862908/admin/streams/table/" target="_blank"><span>Google Analytics</span> </a><a class="dropdown-item" href="https://dash.cloudflare.com/1eed0738e1e1bea17c6a686b2a0b783f/weihao.life" target="_blank"><span>Cloudflare</span></a></div></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle">如何构建股票监听系统</span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> 蓬三水 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-11-15 14:30" pubdate>2023年11月15日 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 1.6k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 14 分钟 </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="padding-left:2rem;margin-right:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">如何构建股票监听系统</h1><p id="updated-time" class="note note-info" style="display:none">本文最后更新于 2025-03-03T21:41:03+08:00</p><div class="markdown-body"><h1 id="如何构建股票监听系统"><a href="#如何构建股票监听系统" class="headerlink" title="如何构建股票监听系统"></a>如何构建股票监听系统</h1><p>在当今信息爆炸的时代，投资者需要及时获取股票市场的动态信息，以便做出明智的投资决策。本文将详细介绍如何构建一个高效的股票监听系统，帮助您实时监控股票价格、设置预警条件，并进行基本的数据分析。</p><h2 id="系统需求分析"><a href="#系统需求分析" class="headerlink" title="系统需求分析"></a>系统需求分析</h2><p>一个完善的股票监听系统应具备以下功能：</p><ol><li><strong>实时数据获取</strong>：能够从可靠的数据源获取股票的实时价格、成交量等信息</li><li><strong>历史数据分析</strong>：支持获取并分析历史交易数据，计算技术指标</li><li><strong>预警机制</strong>：当股票价格达到预设条件时，发送通知</li><li><strong>数据可视化</strong>：以图表形式展示股票走势和技术分析结果</li><li><strong>个性化配置</strong>：允许用户自定义监控的股票和预警条件</li></ol><h2 id="技术架构选择"><a href="#技术架构选择" class="headerlink" title="技术架构选择"></a>技术架构选择</h2><h3 id="后端框架"><a href="#后端框架" class="headerlink" title="后端框架"></a>后端框架</h3><p><strong>Python</strong> 是构建股票监听系统的理想选择，原因如下：</p><ul><li>丰富的数据分析库：pandas、numpy、scipy等</li><li>完善的金融分析工具：TA-Lib（技术分析库）</li><li>强大的数据获取能力：requests、BeautifulSoup、selenium等</li><li>优秀的数据可视化库：matplotlib、plotly等</li></ul><h3 id="数据源选择"><a href="#数据源选择" class="headerlink" title="数据源选择"></a>数据源选择</h3><p>股票数据可以从以下几个渠道获取：</p><ol><li><p><strong>专业金融API</strong>：</p><ul><li><a target="_blank" rel="noopener" href="https://tushare.pro/">Tushare</a>：提供中国股市数据，有免费和付费版本</li><li><a target="_blank" rel="noopener" href="https://finance.sina.com.cn/stock/">新浪财经API</a>：可通过爬虫获取实时数据</li><li><a target="_blank" rel="noopener" href="https://www.eastmoney.com/">东方财富网</a>：丰富的股票数据和新闻资讯</li><li><a target="_blank" rel="noopener" href="https://finance.yahoo.com/">Yahoo Finance API</a>：国际股市数据</li><li><a target="_blank" rel="noopener" href="https://www.alphavantage.co/">Alpha Vantage</a>：提供全球股票数据的API</li></ul></li><li><p><strong>网络爬虫</strong>：</p><ul><li>使用requests + BeautifulSoup抓取财经网站数据</li><li>使用selenium模拟浏览器行为获取动态加载的数据</li></ul></li></ol><h3 id="前端框架"><a href="#前端框架" class="headerlink" title="前端框架"></a>前端框架</h3><p>前端可以选择以下技术栈：</p><ul><li><strong>Vue.js&#x2F;React</strong>：构建响应式用户界面</li><li><strong>ECharts&#x2F;Highcharts</strong>：绘制专业的股票K线图和技术指标图表</li><li><strong>Element UI&#x2F;Ant Design</strong>：提供美观的UI组件</li></ul><h3 id="数据库选择"><a href="#数据库选择" class="headerlink" title="数据库选择"></a>数据库选择</h3><ul><li><strong>MongoDB</strong>：适合存储非结构化的历史数据和用户配置</li><li><strong>MySQL&#x2F;PostgreSQL</strong>：适合存储结构化的股票基本信息和交易数据</li><li><strong>Redis</strong>：用于缓存实时数据，提高系统响应速度</li></ul><h2 id="系统实现步骤"><a href="#系统实现步骤" class="headerlink" title="系统实现步骤"></a>系统实现步骤</h2><h3 id="1-数据采集模块"><a href="#1-数据采集模块" class="headerlink" title="1. 数据采集模块"></a>1. 数据采集模块</h3><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 使用Tushare获取股票数据示例</span>
<span class="token keyword">import</span> tushare <span class="token keyword">as</span> ts

<span class="token comment"># 设置token（需要在Tushare网站注册获取）</span>
ts<span class="token punctuation">.</span>set_token<span class="token punctuation">(</span><span class="token string">'your_token_here'</span><span class="token punctuation">)</span>

<span class="token comment"># 初始化接口</span>
pro <span class="token operator">=</span> ts<span class="token punctuation">.</span>pro_api<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 获取股票日线数据</span>
<span class="token keyword">def</span> <span class="token function">get_stock_daily</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> start_date<span class="token punctuation">,</span> end_date<span class="token punctuation">)</span><span class="token punctuation">:</span>
    df <span class="token operator">=</span> pro<span class="token punctuation">.</span>daily<span class="token punctuation">(</span>ts_code<span class="token operator">=</span>code<span class="token punctuation">,</span> start_date<span class="token operator">=</span>start_date<span class="token punctuation">,</span> end_date<span class="token operator">=</span>end_date<span class="token punctuation">)</span>
    <span class="token keyword">return</span> df

<span class="token comment"># 获取实时行情</span>
<span class="token keyword">def</span> <span class="token function">get_realtime_quotes</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">:</span>
    df <span class="token operator">=</span> ts<span class="token punctuation">.</span>get_realtime_quotes<span class="token punctuation">(</span>code<span class="token punctuation">)</span>
    <span class="token keyword">return</span> df<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure><h3 id="2-数据处理与分析模块"><a href="#2-数据处理与分析模块" class="headerlink" title="2. 数据处理与分析模块"></a>2. 数据处理与分析模块</h3><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> talib <span class="token keyword">as</span> ta

<span class="token comment"># 计算技术指标</span>
<span class="token keyword">def</span> <span class="token function">calculate_indicators</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 确保数据按时间正序排列</span>
    df <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'trade_date'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 计算移动平均线</span>
    df<span class="token punctuation">[</span><span class="token string">'MA5'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ta<span class="token punctuation">.</span>MA<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'MA10'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ta<span class="token punctuation">.</span>MA<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'MA20'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ta<span class="token punctuation">.</span>MA<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 计算MACD指标</span>
    df<span class="token punctuation">[</span><span class="token string">'MACD'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'MACDSignal'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'MACDHist'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ta<span class="token punctuation">.</span>MACD<span class="token punctuation">(</span>
        df<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span> fastperiod<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span> slowperiod<span class="token operator">=</span><span class="token number">26</span><span class="token punctuation">,</span> signalperiod<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 计算KDJ指标</span>
    df<span class="token punctuation">[</span><span class="token string">'K'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'D'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ta<span class="token punctuation">.</span>STOCH<span class="token punctuation">(</span>
        df<span class="token punctuation">[</span><span class="token string">'high'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'low'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span>
        fastk_period<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> slowk_period<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> slowk_matype<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> slowd_period<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> slowd_matype<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> df<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure><h3 id="3-预警系统模块"><a href="#3-预警系统模块" class="headerlink" title="3. 预警系统模块"></a>3. 预警系统模块</h3><figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> smtplib
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText
<span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> Header

<span class="token comment"># 邮件通知功能</span>
<span class="token keyword">def</span> <span class="token function">send_email_alert</span><span class="token punctuation">(</span>receiver<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 发件人信息</span>
    sender <span class="token operator">=</span> <span class="token string">'your_email@example.com'</span>
    password <span class="token operator">=</span> <span class="token string">'your_password'</span>
    
    <span class="token comment"># 邮件内容</span>
    message <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token string">'plain'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    message<span class="token punctuation">[</span><span class="token string">'From'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"股票预警系统"</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    message<span class="token punctuation">[</span><span class="token string">'To'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span>receiver<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    message<span class="token punctuation">[</span><span class="token string">'Subject'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span>subject<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 连接SMTP服务器</span>
        smtp_obj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP_SSL<span class="token punctuation">(</span><span class="token string">'smtp.example.com'</span><span class="token punctuation">,</span> <span class="token number">465</span><span class="token punctuation">)</span>
        smtp_obj<span class="token punctuation">.</span>login<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
        smtp_obj<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> <span class="token punctuation">[</span>receiver<span class="token punctuation">]</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"邮件发送成功"</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> smtplib<span class="token punctuation">.</span>SMTPException <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"邮件发送失败: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 价格预警检测</span>
<span class="token keyword">def</span> <span class="token function">check_price_alerts</span><span class="token punctuation">(</span>stock_code<span class="token punctuation">,</span> current_price<span class="token punctuation">,</span> alert_conditions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> condition <span class="token keyword">in</span> alert_conditions<span class="token punctuation">:</span>
        <span class="token keyword">if</span> condition<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'above'</span> <span class="token keyword">and</span> current_price <span class="token operator">></span> condition<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            send_email_alert<span class="token punctuation">(</span>
                condition<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string-interpolation"><span class="token string">f"股票 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>stock_code<span class="token punctuation">&#125;</span></span><span class="token string"> 价格预警"</span></span><span class="token punctuation">,</span>
                <span class="token string-interpolation"><span class="token string">f"股票 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>stock_code<span class="token punctuation">&#125;</span></span><span class="token string"> 当前价格 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>current_price<span class="token punctuation">&#125;</span></span><span class="token string"> 已超过预警价格 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>condition<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
            <span class="token punctuation">)</span>
        <span class="token keyword">elif</span> condition<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'below'</span> <span class="token keyword">and</span> current_price <span class="token operator">&lt;</span> condition<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            send_email_alert<span class="token punctuation">(</span>
                condition<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string-interpolation"><span class="token string">f"股票 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>stock_code<span class="token punctuation">&#125;</span></span><span class="token string"> 价格预警"</span></span><span class="token punctuation">,</span>
                <span class="token string-interpolation"><span class="token string">f"股票 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>stock_code<span class="token punctuation">&#125;</span></span><span class="token string"> 当前价格 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>current_price<span class="token punctuation">&#125;</span></span><span class="token string"> 已低于预警价格 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>condition<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
            <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure><h3 id="4-数据可视化模块"><a href="#4-数据可视化模块" class="headerlink" title="4. 数据可视化模块"></a>4. 数据可视化模块</h3><p>前端可视化代码示例（使用ECharts）：</p><figure><div class="code-wrapper"><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 初始化股票K线图</span>
<span class="token keyword">function</span> <span class="token function">initStockChart</span><span class="token punctuation">(</span><span class="token parameter">containerId<span class="token punctuation">,</span> stockData</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> chartDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>containerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> myChart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>chartDom<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'股票K线图'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">tooltip</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">trigger</span><span class="token operator">:</span> <span class="token string">'axis'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">axisPointer</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'cross'</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">legend</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'K线'</span><span class="token punctuation">,</span> <span class="token string">'MA5'</span><span class="token punctuation">,</span> <span class="token string">'MA10'</span><span class="token punctuation">,</span> <span class="token string">'MA20'</span><span class="token punctuation">,</span> <span class="token string">'成交量'</span><span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">grid</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span> <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">'10%'</span><span class="token punctuation">,</span> <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token string">'8%'</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">'50%'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span> <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">'10%'</span><span class="token punctuation">,</span> <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token string">'8%'</span><span class="token punctuation">,</span> <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">'63%'</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">'16%'</span> <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">xAxis</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> stockData<span class="token punctuation">.</span>dates<span class="token punctuation">,</span>
                <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">boundaryGap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisLine</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">onZero</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">splitLine</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token string">'dataMin'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token string">'dataMax'</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">gridIndex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> stockData<span class="token punctuation">.</span>dates<span class="token punctuation">,</span>
                <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">boundaryGap</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisLine</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">onZero</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisTick</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">splitLine</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisLabel</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token string">'dataMin'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token string">'dataMax'</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">yAxis</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">splitArea</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">gridIndex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token literal-property property">splitNumber</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisLabel</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisLine</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">axisTick</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">splitLine</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dataZoom</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'inside'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">xAxisIndex</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token literal-property property">start</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
                <span class="token literal-property property">end</span><span class="token operator">:</span> <span class="token number">100</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">xAxisIndex</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'slider'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token string">'85%'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">start</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
                <span class="token literal-property property">end</span><span class="token operator">:</span> <span class="token number">100</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">series</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'K线'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'candlestick'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> stockData<span class="token punctuation">.</span>klineData<span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ec0000'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">color0</span><span class="token operator">:</span> <span class="token string">'#00da3c'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">borderColor</span><span class="token operator">:</span> <span class="token string">'#8A0000'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">borderColor0</span><span class="token operator">:</span> <span class="token string">'#008F28'</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'MA5'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> stockData<span class="token punctuation">.</span>ma5<span class="token punctuation">,</span>
                <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.5</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'MA10'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> stockData<span class="token punctuation">.</span>ma10<span class="token punctuation">,</span>
                <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.5</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'MA20'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> stockData<span class="token punctuation">.</span>ma20<span class="token punctuation">,</span>
                <span class="token literal-property property">smooth</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.5</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'成交量'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">xAxisIndex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token literal-property property">yAxisIndex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token literal-property property">data</span><span class="token operator">:</span> stockData<span class="token punctuation">.</span>volumes
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    
    myChart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure><h3 id="5-系统集成"><a href="#5-系统集成" class="headerlink" title="5. 系统集成"></a>5. 系统集成</h3><p>使用Flask或FastAPI构建后端API：</p><figure><div class="code-wrapper"><pre><code class="python">from flask import Flask, request, jsonify
import json
import pandas as pd

app = Flask(__name__)

# 加载用户配置
def load_user_config():
    with open(&#39;config.json&#39;, &#39;r&#39;) as f:
        return json.load(f)

# 获取股票数据API
@app.route(&#39;/api/stock/daily&#39;, methods=[&#39;GET&#39;])
def get_stock_daily_api():
    code = request.args.get(&#39;code&#39;)
    start_date = request.args.get(&#39;start_date&#39;)
    end_date = request.args.get(&#39;end_date&#39;)
    
    try:
        df = get_stock_daily(code, start_date, end_date)
        df_with_indicators = calculate_indicators(df)
        return jsonify(&#123;
            &#39;status&#39;: &#39;success&#39;,
            &#39;data&#39;: df_with_indicators.to_dict(&#39;records&#39;)
        &#125;)
    except Exception as e:
        return jsonify(&#123;
            &#39;status&#39;: &#39;error&#39;,
            &#39;message&#39;: str(e)
        &#125;), 500

# 设置预警条件API
@app.route(&#39;/api/alerts&#39;, methods=[&#39;POST&#39;])
def set_alert():
    data = request.json
    
    # 验证输入数据
    if not all(k in data for k in [&#39;stock_code&#39;, &#39;type&#39;, &#39;value&#39;, &#39;email&#39;]):
        return jsonify(&#123;
            &#39;status&#39;: &#39;error&#39;,
            &#39;message&#39;: &#39;缺少必要参数&#39;
        &#125;), 400
    
    # 保存预警条件
    try:
        config = load_user_config()
        if &#39;alerts&#39; not in config:
            config[&#39;alerts&#39;] = []
        
        config[&#39;alerts&#39;].append(&#123;
            &#39;stock_code&#39;: data[&#39;stock_code&#39;],
            &#39;type&#39;: data[&#39;type&#39;],
            &#39;value&#39;: float(data[&#39;value&#39;]),
            &#39;email&#39;: data[&#39;email&#39;]
        &#125;)
        
        with open(&#39;config.json&#39;, &#39;w&#39;) as f:
            json.dump(config, f)
        
        return jsonify(&#123;
            &#39;status&#39;: &#39;success&#39;,
            &#39;message&#39;: &#39;预警设置成功&#39;
        &#125;)
    except Exception as e:
        return jsonify(&#123;
            &#39;status&#39;: &#39;error&#39;,
            &#39;message&#39;: str(e
</code></pre></div></figure></div><hr><link defer rel="stylesheet" href="/css/reward.css"><script defer src="/js/reward.js"></script><div class="reward-container"><button id="rewardBtn" class="reward-btn">🎉 打赏作者</button><p class="tea">“觉得不错的话，给点打赏吧 ୧(๑•̀⌄•́๑)૭”</p><div id="rewardImgContainer" class="reward-img-container"><div class="singleImgContainer"><img id="wechatImg" class="reward-img" src="/img/收款码/赞赏码_微信_mini.png" srcset="/img/loading.gif" lazyload onclick='window.open("/img/收款码/赞赏码_微信_mini.png")' alt="微信二维码"><p class="wechatPay">微信</p></div><div class="singleImgContainer"><img id="alipayImg" class="reward-img" src="/img/收款码/收款码_支付宝_mini.png" srcset="/img/loading.gif" lazyload onclick='window.open("/img/收款码/收款码_支付宝_mini.png")' alt="支付宝二维码"><p class="aliPay">支付宝</p></div></div></div><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88/" class="category-chain-item">技术方案</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E8%82%A1%E7%A5%A8/" class="print-no-link">#股票</a> <a href="/tags/%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/" class="print-no-link">#监控系统</a> <a href="/tags/Python/" class="print-no-link">#Python</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" class="print-no-link">#数据分析</a></div></div><div class="license-box my-3"><div class="license-title"><div>如何构建股票监听系统</div><div>https://weihao.life/posts/stock-monitor.html</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>蓬三水</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2023年11月15日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/posts/6ba6ac33.html" title="WIN10：命令行修改壁纸，补充到自动切换任务中"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">WIN10：命令行修改壁纸，补充到自动切换任务中</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"></article></div></div><article id="comments" lazyload><div id="giscus" class="giscus"></div><script>Fluid.utils.loadComments("#giscus",function(){var t,e={repo:"addpd/addpd.github.io","repo-id":"R_kgDOJALjWw",category:"Announcements","category-id":"DIC_kwDOJALjW84Cj_y5","theme-light":"light","theme-dark":"dark",mapping:"title","reactions-enabled":1,"emit-metadata":0,"input-position":"top",lang:"zh-CN","data-loading":"lazy",crossorigin:"anonymous"},i={};for(t in e)t.startsWith("theme-")||(i[t.startsWith("data-")?t:"data-"+t]=e[t]);var n,a="light",o="dark";for(n in window.GiscusThemeLight=a,window.GiscusThemeDark=o,i["data-theme"]="dark"===document.documentElement.getAttribute("data-user-color-scheme")?o:a,i){var r=i[n];null!=r&&""!==r||delete i[n]}var s,d=document.createElement("script");for(s in d.setAttribute("src","https://giscus.app/client.js"),d.setAttribute("crossorigin","anonymous"),i)d.setAttribute(s,i[s]);o=document.getElementsByTagName("script"),a=0<o.length?o[o.length-1]:document.head||document.documentElement;a.parentNode.insertBefore(d,a.nextSibling)})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="/baomitu/twitter-bootstrap@4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script>var relativeDate=function(){var t,e,i,n=document.getElementById("updated-time");n&&((i=(t=n.textContent).match(e=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|[+-]\d{2}:\d{2})/))&&(i=moment(i[0]).fromNow(),n.textContent=t.replace(e,i)),n.style.display="")};Fluid.utils.createScript("https://lib.baomitu.com/moment.js/2.29.4/moment.min.js",function(){"zh-cn".startsWith("en")?relativeDate():Fluid.utils.createScript("https://lib.baomitu.com/moment.js/2.29.4/locale/zh-cn.min.js",function(){relativeDate()})})</script><script src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>